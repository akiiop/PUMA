

U2 = [-1,sqrt(2);sqrt(2),1]/sqrt(3);

U4 = [1,1,1,0;1,-1,0,1;1,0,-1,-1;0,1,-1,1]/sqrt(3);

U = blkdiag(U2,U4);

%[a_f,b_f,c_f] = Multiport_Decomposition(U,[],6,3*30,'MS');

T = [0.32616497+0.169709745i,-0.38944321+0.385222961i,-0.07487433+0.0140016576i,-0.56092302+0.144894222i,-0.09178299+0.182186722i,-0.37672097-0.199464971i;
    -0.59574492+0.341910943i,-0.06002442+0.0889329420i,0.16555801+0.101417636i,-0.23277056+0.332764918i,0.50921371-0.219642136i,0.04267885-0.0685604080i;
    -0.11404973-0.0005635556i,0.50625739-0.0702574186i,-0.28217237-0.692726708i,-0.22904901-0.008906423i,0.0634065+0.0378401459i,-0.17627259-0.277850848i;
    0.21269847+0.405463432i,-0.01962757+0.030734163i,0.00386132-0.166814050i,0.11549117-0.405381161i,0.52450465+0.316155727i,-0.12388211+0.439441303i;
    -0.19696007+0.129259070i,-0.2829352+0.136684498i,-0.23585629-0.394794001i,-0.07037407+0.253348908i,-0.32129528+0.173338317i,0.47736737+0.451640055i;
    0.02205175-0.338176828i,-0.57000713+0.0471133316i,-0.12412351-0.377189984i,0.43404681+0.108197637i,0.33695188-0.153353789i,-0.13322881-0.21315768i];
T = UnitaryProjection(T);

[a_t,b_t,c_t] = Multiport_Decomposition(U,T,6,3*30,'MS');

b_f %1.9986e-12 1.0620e-12
b_t %2.7369e-09 1.9380e-12
